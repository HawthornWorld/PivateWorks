{"remainingRequest":"/Users/mrc/jsProj/PivateWorks/lottery/node_modules/babel-loader/lib/index.js!/Users/mrc/jsProj/PivateWorks/lottery/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/mrc/jsProj/PivateWorks/lottery/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/mrc/jsProj/PivateWorks/lottery/src/components/ChapterStar.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/mrc/jsProj/PivateWorks/lottery/src/components/ChapterStar.vue","mtime":1553363562000},{"path":"/Users/mrc/jsProj/PivateWorks/lottery/node_modules/cache-loader/dist/cjs.js","mtime":1551613478189},{"path":"/Users/mrc/jsProj/PivateWorks/lottery/node_modules/babel-loader/lib/index.js","mtime":1551613443346},{"path":"/Users/mrc/jsProj/PivateWorks/lottery/node_modules/cache-loader/dist/cjs.js","mtime":1551613478189},{"path":"/Users/mrc/jsProj/PivateWorks/lottery/node_modules/vue-loader/lib/index.js","mtime":1551613480809}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/es6.object.to-string\";\nimport \"core-js/modules/es6.regexp.match\";\nimport \"core-js/modules/es6.regexp.constructor\";\nimport _parseInt from \"/Users/mrc/jsProj/PivateWorks/lottery/node_modules/@babel/runtime-corejs2/core-js/parse-int\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport util from '../vendors/util.js';\nvar BASE_URL = '../assets/images';\nexport default {\n  name: 'star',\n  data: function data() {\n    return {\n      chapterId: util.getQuery('chapterid'),\n      userScore: 0,\n      comment: '',\n      cookieId: '',\n      placeHolder: this.userLang.starCnt,\n      starObj: [{\n        txt: this.userLang.starC,\n        score: 1\n      }, {\n        txt: this.userLang.starB,\n        score: 2\n      }, {\n        txt: this.userLang.starA,\n        score: 3\n      }]\n    };\n  },\n  props: {\n    userLang: {\n      type: Object,\n      default: {}\n    }\n  },\n  mounted: function mounted() {\n    //判断cookie中是否有uuid，若无，则写入\n    this.cookieId = this.getCookie('uuid');\n\n    if (!this.cookieId) {\n      this.cookieId = this.generateUid();\n      this.setCookie('uuid', this.cookieId, 365);\n    }\n  },\n  methods: {\n    starHandle: function starHandle(e) {\n      //star时高亮星星\n      var doms = document.getElementsByClassName('bg');\n      Array.prototype.slice.call(doms).forEach(function (item) {\n        item.classList.remove('light');\n      });\n      e.target.classList.add('light'); //获取用户分数\n\n      this.userScore = _parseInt(e.target.dataset.score);\n    },\n\n    /**\n     * 获取输入框内容\n     */\n    getInput: function getInput(e) {\n      this.comment = e.target.value;\n    },\n\n    /**\n     * 获取cookie标识\n     */\n    getCookie: function getCookie(name) {\n      var arr,\n          reg = new RegExp('(^| )' + name + '=([^;]*)(;|$)');\n\n      if (arr = document.cookie.match(reg)) {\n        return unescape(arr[2]);\n      } else {\n        return '';\n      }\n    },\n    setCookie: function setCookie(name, value, expiredays) {\n      var exdate = new Date();\n      exdate.setDate(exdate.getDate() + expiredays);\n      document.cookie = name + '=' + escape(value) + (expiredays == null ? '' : ';expires=' + exdate.toGMTString());\n    },\n\n    /**\n     * 随机生成无重复字符串\n     */\n    generateUid: function generateUid() {\n      var s = function s() {\n        return ((1 + Math.random()) * 0x10000 | 0).toString(16).substring(1);\n      };\n\n      return s() + s() + '-' + s() + '-' + s() + '-' + s() + '-' + s() + s() + s();\n    },\n\n    /**\n     * 提交评分和评论\n     */\n    submitHandle: function submitHandle() {\n      // 点击提交,一起提交star && comment,star必选，comment可选\n      if (!this.userScore) {\n        //提示star必选\n        this.$toast('请为本章节打分');\n        return;\n      } //提交\n\n\n      this.submitStar();\n    },\n\n    /**\n     * 提交评分和评论\n     */\n    submitStar: function submitStar() {\n      var _this = this;\n\n      var markBook = '//previewapi.raymangaapp.com/previewapi/v1/common/markBook';\n      this.$axios.post(markBook, {\n        cookie_id: this.cookieId,\n        chapter_id: _parseInt(this.chapterId),\n        score: this.userScore,\n        suggestion: this.comment || ''\n      }).then(function (res) {\n        /**\n         * 状态码\n         * 1     ：成功\n         * 2000  ：常规错误\n         * 2001  ：参数错误\n         * 2002  ：数据库连接错误\n         */\n        var code = res.data.code;\n\n        if (code === 1) {\n          _this.$toast('提交成功');\n        } else if (code === 2000) {\n          _this.$toast('常规错误(2000)');\n        } else if (code === 2001) {\n          _this.$toast('参数错误(2001)');\n        } else if (code === 2002) {\n          _this.$toast('数据库连接错误(2002)');\n        }\n      }).catch(function (error) {\n        _this.$toast('网络繁忙，请稍后再试');\n      });\n    }\n  }\n};",{"version":3,"sources":["ChapterStar.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"star-wrapper\">\n    <div class=\"title\">{{userLang.starTitle}}</div>\n    <div class=\"desc\">{{userLang.starSubTitle}}</div>\n    <div class=\"star\">\n      <ul class=\"list\">\n        <li v-for=\"(item,idx) in starObj\">\n          <span class=\"bg\" :data-score=\"item.score\" @click=\"starHandle\"></span>\n          <span class=\"txt\">{{item.txt}}</span>\n        </li>\n      </ul>\n    </div>\n    <div class=\"text\">\n      <textarea type=\"text\" rows=\"4\" :placeholder=\"placeHolder\" v-model.trim=\"comment\" @keyup.stop=\"getInput\">\n      </textarea>\n    </div>\n    <div class=\"submit\" @click=\"submitHandle\">{{userLang.submitBtn}}</div>\n  </div>\n</template>\n\n<script>\nimport util from '../vendors/util.js';\n\nconst BASE_URL = '../assets/images';\nexport default {\n  name: 'star',\n  data() {\n    return {\n      chapterId: util.getQuery('chapterid'),\n      userScore: 0,\n      comment: '',\n      cookieId: '',\n      placeHolder: this.userLang.starCnt,\n      starObj: [\n        {\n          txt: this.userLang.starC,\n          score: 1,\n        },\n        {\n          txt: this.userLang.starB,\n          score: 2,\n        },\n        {\n          txt: this.userLang.starA,\n          score: 3,\n        },\n      ],\n    };\n  },\n  props: {\n    userLang: {\n      type: Object,\n      default: {}\n    }\n  },\n  mounted() {\n    //判断cookie中是否有uuid，若无，则写入\n    this.cookieId = this.getCookie('uuid');\n    if (!this.cookieId) {\n      this.cookieId = this.generateUid();\n      this.setCookie('uuid', this.cookieId, 365);\n    }\n  },\n  methods: {\n    starHandle(e) {\n      //star时高亮星星\n      let doms = document.getElementsByClassName('bg');\n      Array.prototype.slice.call(doms).forEach(item => {\n        item.classList.remove('light');\n      });\n      e.target.classList.add('light');\n\n      //获取用户分数\n      this.userScore = parseInt(e.target.dataset.score);\n    },\n    /**\n     * 获取输入框内容\n     */\n    getInput(e) {\n      this.comment = e.target.value;\n    },\n    /**\n     * 获取cookie标识\n     */\n    getCookie(name) {\n      let arr,\n        reg = new RegExp('(^| )' + name + '=([^;]*)(;|$)');\n      if ((arr = document.cookie.match(reg))) {\n        return unescape(arr[2]);\n      } else {\n        return ''\n      }\n    },\n    setCookie(name, value, expiredays) {\n      var exdate = new Date();\n      exdate.setDate(exdate.getDate() + expiredays);\n      document.cookie =\n        name +\n        '=' +\n        escape(value) +\n        (expiredays == null ? '' : ';expires=' + exdate.toGMTString());\n    },\n    /**\n     * 随机生成无重复字符串\n     */\n    generateUid() {\n      let s = () => {\n        return (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);\n      };\n      return (\n        s() + s() + '-' + s() + '-' + s() + '-' + s() + '-' + s() + s() + s()\n      );\n    },\n    /**\n     * 提交评分和评论\n     */\n    submitHandle() {\n      // 点击提交,一起提交star && comment,star必选，comment可选\n      if (!this.userScore) {\n        //提示star必选\n        this.$toast('请为本章节打分');\n        return;\n      }\n      //提交\n      this.submitStar();\n    },\n    /**\n     * 提交评分和评论\n     */\n    submitStar() {\n      \n      const markBook =\n        '//previewapi.raymangaapp.com/previewapi/v1/common/markBook';\n      this.$axios\n        .post(markBook, {\n          cookie_id: this.cookieId,\n          chapter_id: parseInt(this.chapterId),\n          score: this.userScore,\n          suggestion: this.comment || '',\n        })\n        .then(res => {\n          /**\n           * 状态码\n           * 1     ：成功\n           * 2000  ：常规错误\n           * 2001  ：参数错误\n           * 2002  ：数据库连接错误\n           */\n          const { code } = res.data;\n          if (code === 1) {\n            this.$toast('提交成功')\n          } else if (code === 2000) {\n            this.$toast('常规错误(2000)');\n          } else if (code === 2001) {\n            this.$toast('参数错误(2001)');\n          } else if (code === 2002) {\n            this.$toast('数据库连接错误(2002)');\n          }\n        })\n        .catch(error => {\n          this.$toast('网络繁忙，请稍后再试');\n        });\n    },\n  },\n};\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style lang=\"scss\" scoped>\n@import '../assets/scss/common.scss';\n.star-wrapper {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  color: #5a5a5a;\n  padding: 0 rem(128px);\n  box-sizing: border-box;\n\n  .title {\n    font-size: rem(48px);\n    font-weight: bold;\n  }\n  .desc {\n    font-size: rem(36px);\n    margin: rem(50px) 0 rem(100px);\n  }\n  .star {\n    .list {\n      display: flex;\n      flex-direction: row;\n      align-items: center;\n    }\n    li {\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      width: 90px;\n      .bg {\n        display: inline-block;\n        width: rem(72px);\n        height: rem(72px);\n        background-image: url(#{$base}/ic_reader_navigation_favorite.png);\n        background-size: 100%;\n        background-position: center center;\n        background-repeat: no-repeat;\n      }\n      .bg.light {\n        background-image: url(#{$base}/ic_favorite_highlight.png);\n      }\n      .txt {\n        color: #5a5a5a;\n        font-size: rem(40px);\n        font-weight: bold;\n      }\n    }\n  }\n  .text {\n    width: 100%;\n    margin: rem(80px) 0 rem(42px);\n    textarea {\n      width: 100%;\n      height: rem(278px);\n      color: #7e7e7e;\n      background: #e8e8e8;\n      border: none;\n      outline: none;\n      resize: none;\n      padding: rem(20px) rem(28px);\n    }\n  }\n  .submit {\n    width: rem(336px);\n    height: rem(110px);\n    line-height: rem(110px);\n    color: #fff;\n    font-size: rem(36px);\n    background: #ff6666;\n    border-radius: rem(110px);\n    text-align: center;\n  }\n}\n</style>\n"],"sourceRoot":"src/components"}]}